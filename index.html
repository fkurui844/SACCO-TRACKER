<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>TIMES SACCO - FlexiLog</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CSS - PRESERVING YOUR ORIGINAL STYLES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#f5f7f5;--card:#fff;--surface:#eef2ee;--border:#dde8dd;
  --accent:#1a7a3c;--alight:#e8f5ed;--accent2:#f0a500;
  --red:#e53935;--rlight:#fdecea;--text:#1a2e1a;--muted:#6a8a6a;
  --shadow:0 2px 16px rgba(26,122,60,.10);--shlg:0 8px 32px rgba(26,122,60,.15);
  --font-d:'Bebas Neue',sans-serif;--font-m:'Space Mono',monospace;--font-b:'DM Sans',sans-serif;
}
[data-theme="dark"]{
  --bg:#0d1410;--card:#141f18;--surface:#1a2820;--border:#2a3e2e;
  --accent:#22c55e;--alight:#0d2a1a;--accent2:#f0a500;
  --red:#ef4444;--rlight:#2a0f0f;--text:#e0f0e4;--muted:#5a8a6a;
  --shadow:0 2px 16px rgba(0,0,0,.4);--shlg:0 8px 32px rgba(0,0,0,.5);
}
body{background:var(--bg);color:var(--text);font-family:var(--font-b);min-height:100vh;max-width:480px;margin:0 auto;transition:background .3s,color .3s}

header{background:var(--accent);padding:13px 16px 10px;position:sticky;top:0;z-index:100}
.hrow{display:flex;align-items:center;justify-content:space-between;margin-bottom:3px}
.logo{font-family:var(--font-d);font-size:1.6rem;letter-spacing:3px;color:#fff}
.logo span{color:var(--accent2)}
.dbadge{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.2);padding:4px 9px;font-family:var(--font-m);font-size:.52rem;color:#fff;letter-spacing:1px;cursor:pointer}

.bnav{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:480px;background:var(--card);border-top:2px solid var(--border);display:grid;grid-template-columns:1fr 1fr 1fr;z-index:100}
.nbtn{padding:9px 4px;text-align:center;cursor:pointer;border:none;background:transparent}
.nbtn.active{background:var(--alight)}
.nbtn .nl{font-family:var(--font-m);font-size:.46rem;color:var(--muted);text-transform:uppercase}
.nbtn.active .nl{color:var(--accent)}

main{padding:13px 13px 74px}
.page{display:none}.page.active{display:block}
.card{background:var(--card);border:1px solid var(--border);padding:16px;margin-bottom:12px;box-shadow:var(--shadow)}
.ctitle{font-family:var(--font-d);font-size:1.2rem;color:var(--accent);letter-spacing:2px;margin-bottom:4px}
.csub{font-family:var(--font-m);font-size:.52rem;color:var(--muted);margin-bottom:13px}

.field{margin-bottom:10px}
.field label{display:block;font-family:var(--font-m);font-size:.5rem;color:var(--muted);text-transform:uppercase;margin-bottom:4px}
.field select,.field input{width:100%;background:var(--bg);border:1px solid var(--border);color:var(--text);padding:11px;font-family:var(--font-b);outline:none}

.atabs{display:flex;gap:0;margin-bottom:12px;border-bottom:2px solid var(--border)}
.atab{font-family:var(--font-m);font-size:.48rem;padding:8px 10px;cursor:pointer;color:var(--muted);border:none;background:transparent;text-transform:uppercase}
.atab.active{color:var(--accent);border-bottom:2px solid var(--accent)}
.asect{display:none}.asect.active{display:block}

.aitem{display:flex;align-items:center;justify-content:space-between;padding:10px;background:var(--card);border:1px solid var(--border);margin-bottom:6px}
.adel{background:none;border:1px solid var(--border);color:var(--red);padding:4px 8px;cursor:pointer;font-size:0.6rem}
.addrow{display:flex;gap:7px;align-items:end}

.bb{width:100%;padding:13px;font-family:var(--font-d);font-size:1.1rem;letter-spacing:3px;cursor:pointer;border:none;margin-bottom:7px}
.bstart{background:var(--accent);color:#fff}
.toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:var(--text);color:var(--bg);padding:8px 16px;font-size:.6rem;z-index:999;display:none}
.toast.show{display:block}
</style>
</head>
<body>

<header>
  <div class="hrow">
    <div class="logo">TIMES<span> SACCO</span></div>
    <div class="dbadge" id="driverBadge" onclick="switchPage('log')">â€” LOGIN â€”</div>
  </div>
</header>

<main>
  <div id="page-log" class="page active">
    <div id="setup-view">
        <div class="card">
            <div class="ctitle">SHIFT SETUP</div>
            <div class="csub">MANUAL ENTRY IS DISABLED. PLEASE SELECT FROM LIST.</div>
            
            <div class="field">
                <label>Select Driver</label>
                <select id="driverSelect"></select>
            </div>
            <div class="field">
                <label>Select Vehicle</label>
                <select id="carSelect"></select>
            </div>
            <button class="bb bstart" onclick="startShift()">START SHIFT</button>
        </div>
    </div>

    <div id="active-log-view" style="display:none">
        <div class="card">
            <div class="ctitle">TRIP IN PROGRESS</div>
            <p id="currentSessionInfo" style="font-size: 0.8rem; margin-bottom: 15px; color: var(--muted)"></p>
            <button class="bb" style="background: var(--red); color: white;" onclick="endShift()">END SHIFT</button>
        </div>
    </div>
  </div>

  <div id="page-reports" class="page">
    <div class="card">
        <div class="ctitle">REPORTS</div>
        <div class="empty">Recent activity will appear here.</div>
    </div>
  </div>

  <div id="page-admin" class="page">
    <div class="atabs">
        <button class="atab active" onclick="switchAdminTab('drivers')">Drivers</button>
        <button class="atab" onclick="switchAdminTab('cars')">Cars</button>
    </div>

    <div id="asect-drivers" class="asect active">
        <div class="card">
            <div class="field">
                <label>Add Driver Name</label>
                <div class="addrow">
                    <input type="text" id="newDriverName" placeholder="e.g. JOHN DOE">
                    <button class="bb bstart" style="width: 80px; padding: 10px; margin: 0;" onclick="addItem('drivers')">ADD</button>
                </div>
            </div>
        </div>
        <div id="admin-drivers-list"></div>
    </div>

    <div id="asect-cars" class="asect">
        <div class="card">
            <div class="field">
                <label>Add Vehicle Plate</label>
                <div class="addrow">
                    <input type="text" id="newCarPlate" placeholder="e.g. KCA 001X">
                    <button class="bb bstart" style="width: 80px; padding: 10px; margin: 0;" onclick="addItem('cars')">ADD</button>
                </div>
            </div>
        </div>
        <div id="admin-cars-list"></div>
    </div>
  </div>
</main>

<nav class="bnav">
  <button class="nbtn active" id="nav-log" onclick="switchPage('log')">
    <span class="nl">ğŸšŒ LOG TRIP</span>
  </button>
  <button class="nbtn" id="nav-reports" onclick="switchPage('reports')">
    <span class="nl">ğŸ“Š REPORTS</span>
  </button>
  <button class="nbtn" id="nav-admin" onclick="switchPage('admin')">
    <span class="nl">ğŸ‘‘ ADMIN</span>
  </button>
</nav>

<div class="toast" id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA HANDLERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DEFAULTS = {
    drivers: ['FESTUS KIPKURUI','TOM WASIKE','FELIX OTIENO','MUTUA KIRUI','JANETH TIONY','ABIGAEL CHEPKORIR','GRACE WANGECHI'],
    cars: ['KBZ 300','KBY 400','KBU 500','KCA 200','KDY 260W','KYA 520X','KAF 2601']
};

function load(k, d) { 
    const v = localStorage.getItem(k); 
    return v ? JSON.parse(v) : d; 
}
function save(k, v) { localStorage.setItem(k, JSON.stringify(v)); }

let DRIVERS = load('fs_drivers', DEFAULTS.drivers);
let CARS = load('fs_cars', DEFAULTS.cars);
let activeShift = load('fs_active_shift', null);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CORE LOGIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function init() {
    renderSelects();
    updateBadge();
    if(activeShift) showActiveView();
}

function switchPage(p) {
    document.querySelectorAll('.page').forEach(pg => pg.classList.remove('active'));
    document.querySelectorAll('.nbtn').forEach(bn => bn.classList.remove('active'));
    document.getElementById('page-' + p).classList.add('active');
    document.getElementById('nav-' + p).classList.add('active');
    if(p === 'admin') renderAdminLists();
    if(p === 'log') renderSelects();
}

function switchAdminTab(t) {
    document.querySelectorAll('.asect').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.atab').forEach(b => b.classList.remove('active'));
    document.getElementById('asect-' + t).classList.add('active');
    event.target.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIST MANAGEMENT (MANUAL UPDATES)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderAdminLists() {
    const dList = document.getElementById('admin-drivers-list');
    const cList = document.getElementById('admin-cars-list');

    dList.innerHTML = DRIVERS.map((d, i) => `
        <div class="aitem"><span>${d}</span><button class="adel" onclick="deleteItem('drivers', ${i})">REMOVE</button></div>
    `).join('');

    cList.innerHTML = CARS.map((c, i) => `
        <div class="aitem"><span>${c}</span><button class="adel" onclick="deleteItem('cars', ${i})">REMOVE</button></div>
    `).join('');
}

function addItem(type) {
    const input = type === 'drivers' ? document.getElementById('newDriverName') : document.getElementById('newCarPlate');
    const val = input.value.trim().toUpperCase();
    
    if(!val) return showToast("Enter a value");
    
    if(type === 'drivers') {
        DRIVERS.push(val);
        save('fs_drivers', DRIVERS);
    } else {
        CARS.push(val);
        save('fs_cars', CARS);
    }
    
    input.value = '';
    renderAdminLists();
    showToast("Added Successfully");
}

function deleteItem(type, index) {
    if(!confirm("Remove this item?")) return;
    if(type === 'drivers') {
        DRIVERS.splice(index, 1);
        save('fs_drivers', DRIVERS);
    } else {
        CARS.splice(index, 1);
        save('fs_cars', CARS);
    }
    renderAdminLists();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SHIFT LOGIC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderSelects() {
    const dSel = document.getElementById('driverSelect');
    const cSel = document.getElementById('carSelect');
    
    dSel.innerHTML = DRIVERS.map(d => `<option value="${d}">${d}</option>`).join('');
    cSel.innerHTML = CARS.map(c => `<option value="${c}">${c}</option>`).join('');
}

function startShift() {
    const d = document.getElementById('driverSelect').value;
    const c = document.getElementById('carSelect').value;
    
    activeShift = { driver: d, car: c, startTime: new Date().toLocaleTimeString() };
    save('fs_active_shift', activeShift);
    showActiveView();
    updateBadge();
    showToast("Shift Started");
}

function showActiveView() {
    document.getElementById('setup-view').style.display = 'none';
    document.getElementById('active-log-view').style.display = 'block';
    document.getElementById('currentSessionInfo').textContent = `Driver: ${activeShift.driver} | Car: ${activeShift.car}`;
}

function endShift() {
    activeShift = null;
    localStorage.removeItem('fs_active_shift');
    document.getElementById('setup-view').style.display = 'block';
    document.getElementById('active-log-view').style.display = 'none';
    updateBadge();
    showToast("Shift Ended");
}

function updateBadge() {
    const b = document.getElementById('driverBadge');
    b.textContent = activeShift ? activeShift.driver : 'â€” LOGIN â€”';
}

function showToast(m) {
    const t = document.getElementById('toast');
    t.textContent = m;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
}

// Run on Load
init();
</script>
</body>
</html>
